(()=>{"use strict";const t=t=>{const e="shopify-section-",a=t.closest(`[id^="${e}"]`);if(!a)return[null,null];return[a.id.replace(e,""),a]},e=(t,e,a)=>{t.querySelectorAll(`[${e}]`).forEach((t=>{const n=t.getAttribute(e);n&&(a?t.classList.add(n):t.classList.remove(n))}))};class a extends HTMLElement{#t;#e="[[value]]";#a={undefined:"undefined",available:"available",not_available:"not-available",does_not_exist:"does-not-exist"};#n="js-product-option-";dataAttributes={};optionName;$productSection;constructor(t){super(),this.#t=t,this.dataAttributes={name:`data-${t}-name`,valueLabel:`data-${t}-value`,classPrefix:`data-${t}-class-prefix`}}connectedCallbackStart(){if(this.optionName=this.getAttribute(this.dataAttributes.name),void 0===this.optionName||""===this.optionName)throw new Error(`[${this.#t}] [Product option name is not set]`);if(this.$productSection=this.closest("product-section"),!this.$productSection)throw new Error(`[${this.#t}] [A related product-section element is not found]`);this.#n=this.getAttribute(this.dataAttributes.classPrefix)||this.#n}connectedCallbackEnd(){this.$productSection.addEventListener("statechange",(()=>{this.render()})),this.$productSection.state&&this.render()}getOptionState(){return this.$productSection.state.optionsValues.find((t=>t.name===this.optionName))}#i(t){const e=this.$productSection.state.optionsAvailability[this.optionName];let a=this.#a.undefined;return e&&(t in e?e[t]?this.#a.available:this.#a.not_available:this.#a.does_not_exist),a}addAvailabilityClass(t,e){t.classList.remove(...Object.values(this.#a).map((t=>this.#n+t))),t.classList.add(this.#n+this.#i(e))}render(){const t=this.getOptionState();if(t){const e=t.value;this.querySelectorAll(`[${this.dataAttributes.valueLabel}]`).forEach((t=>{if(!e)return void(t.innerHTML="");const a=t.getAttribute(this.dataAttributes.valueLabel)||this.#e;t.innerHTML=a.replaceAll(this.#e,e)}))}}}const n="facets-form",i={ajaxInput:`data-${n}-input`,content:`data-${n}-content`,link:`data-${n}-link`};let o,s=[],r=window.location.search.slice(1),l=window.location.search.slice(1);function c(e,a=!0){try{o&&(o.abort(),o=void 0),l=e;const r={};document.querySelectorAll(`[${i.content}]`).forEach((e=>{const[a]=t(e);if(!a)throw new Error(`[${n}] [The "${i.content}" element must be within a Shopify section]`);r[a]=!0}));const c=Object.keys(r);if(c.length>5)throw new Error(`[${n}] [The "${i.content}" elements exist in more than 5 sections]`);const m=`${window.location.pathname}?sections=${c.join(",")}&${e}`,f=s.find((t=>t.url===m));f?d(f.html):(o=new AbortController,h(!0),u(!0),fetch(m,{signal:o.signal}).then((t=>t.json())).then((t=>{let e="";for(let a in t)e+=t[a];s.push({url:m,html:e}),d(e)})).catch((t=>{"AbortError"!==t.name&&(console.error(`[${n}] [Section API request error]`,t),window.location.href=`?${e}`)})).finally((()=>{u(!1),h(!1)}))),a&&history.pushState({searchParams:e},"",`${window.location.pathname}${e&&"?".concat(e)}`)}catch(t){console.error(t),window.location.href=`?${e}`}}function u(t){document.querySelectorAll(`[${i.ajaxInput}][type="number"], [${i.ajaxInput}][type="text"]`).forEach((e=>{e.readOnly=t}))}function h(t){e(document,i.loadingClass,t)}function d(t){const e=(new DOMParser).parseFromString(t,"text/html");document.querySelectorAll(`[${i.content}]`).forEach((t=>{const a=t.getAttribute(i.content);if(!a)throw new Error(`[${n}] [A "${i.content}" element doesn't have unique value]`);const o=e.querySelector(`[${i.content}="${a}"]`);if(!o)throw new Error(`[${n}] [A "${i.content}" element with "${a}" value isn't found in the section API response]`);t.innerHTML=o.innerHTML}))}window.addEventListener("popstate",(t=>{const e=t.state?t.state.searchParams:r;e!==l&&c(e,!1)})),document.addEventListener("click",(t=>{const e=t.target.closest(`[${i.link}]`);if(!e)return;const a=e.href;a&&(c(new URL(a).searchParams.toString()),t.preventDefault())}));class m extends HTMLElement{#o;connectedCallback(){if(this.#o=this.querySelector("form"),!this.#o)throw new Error(`[${n}] [The "form" element isn't found]`);this.#o.addEventListener("submit",(t=>{t.preventDefault(),this.#s()})),document.body.addEventListener("change",(t=>{t.target.form===this.#o&&t.target.hasAttribute(i.ajaxInput)&&this.#s()}))}#s(){const t=new FormData(this.#o);c(new URLSearchParams(t).toString())}}customElements.define(n,m)})();