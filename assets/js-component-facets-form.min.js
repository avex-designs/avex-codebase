(()=>{"use strict";const t=t=>{const e="shopify-section-",n=t.closest(`[id^="${e}"]`);if(!n)return[null,null];return[n.id.replace(e,""),n]},e=(t,e,n)=>{t.querySelectorAll(`[${e}]`).forEach((t=>{const o=t.getAttribute(e);o&&(n?t.classList.add(o):t.classList.remove(o))}))};const n="facets-form",o={ajaxInput:`data-${n}-input`,content:`data-${n}-content`,link:`data-${n}-link`};let r,a=[],s=window.location.search.slice(1),c=window.location.search.slice(1);function i(e,s=!0){try{r&&(r.abort(),r=void 0),c=e;const i={};document.querySelectorAll(`[${o.content}]`).forEach((e=>{const[r]=t(e);if(!r)throw new Error(`[${n}] [The "${o.content}" element must be within a Shopify section]`);i[r]=!0}));const m=Object.keys(i);if(m.length>5)throw new Error(`[${n}] [The "${o.content}" elements exist in more than 5 sections]`);const f=`${window.location.pathname}?sections=${m.join(",")}&${e}`,d=a.find((t=>t.url===f));d?u(d.html):(r=new AbortController,h(!0),l(!0),fetch(f,{signal:r.signal}).then((t=>t.json())).then((t=>{let e="";for(let n in t)e+=t[n];a.push({url:f,html:e}),u(e)})).catch((t=>{"AbortError"!==t.name&&(console.error(`[${n}] [Section API request error]`,t),window.location.href=`?${e}`)})).finally((()=>{l(!1),h(!1)}))),s&&history.pushState({searchParams:e},"",`${window.location.pathname}${e&&"?".concat(e)}`)}catch(t){console.error(t),window.location.href=`?${e}`}}function l(t){document.querySelectorAll(`[${o.ajaxInput}][type="number"], [${o.ajaxInput}][type="text"]`).forEach((e=>{e.readOnly=t}))}function h(t){e(document,o.loadingClass,t)}function u(t){const e=(new DOMParser).parseFromString(t,"text/html");document.querySelectorAll(`[${o.content}]`).forEach((t=>{const r=t.getAttribute(o.content);if(!r)throw new Error(`[${n}] [A "${o.content}" element doesn't have unique value]`);const a=e.querySelector(`[${o.content}="${r}"]`);if(!a)throw new Error(`[${n}] [A "${o.content}" element with "${r}" value isn't found in the section API response]`);t.innerHTML=a.innerHTML}))}window.addEventListener("popstate",(t=>{const e=t.state?t.state.searchParams:s;e!==c&&i(e,!1)})),document.addEventListener("click",(t=>{const e=t.target.closest(`[${o.link}]`);if(!e)return;const n=e.href;n&&(i(new URL(n).searchParams.toString()),t.preventDefault())}));class m extends HTMLElement{#t;connectedCallback(){if(this.#t=this.querySelector("form"),!this.#t)throw new Error(`[${n}] [The "form" element isn't found]`);this.#t.addEventListener("submit",(t=>{t.preventDefault(),this.#e()})),document.body.addEventListener("change",(t=>{t.target.form===this.#t&&t.target.hasAttribute(o.ajaxInput)&&this.#e()}))}#e(){const t=new FormData(this.#t);i(new URLSearchParams(t).toString())}}customElements.define(n,m)})();