(()=>{const e="custom-select",t={placeholder:"placeholder",optionValue:"data-custom-select-option-value",optionValueLowerCase:"data-custom-select-option-value-lowercase",optionIndex:"data-custom-select-option-index",optionSelected:"data-custom-select-option-selected",stateSelected:"data-custom-select-selected"};class s extends HTMLElement{constructor(){if(super(),this.$select=this.querySelector("select"),!this.$select)throw new Error("[custom-select] [Custom select must contain real select element]");this.$select.setAttribute("hidden",!0),this.setAttribute("tabindex","0"),this.$options=Array.from(this.$select.querySelectorAll("option")),this.selectedOption=this.$options.find((e=>e.selected)),this.placeholder=this.getAttribute(t.placeholder),this.$selectedOption=null,this.$currentOption=null,this.pressedKey="",this.renderSelect(),this.addEventListener("click",this.onClick),this.mutationObserver=new MutationObserver(this.renderSelect.bind(this)),this.mutationObserver.observe(this.$select,{childList:!0,subtree:!0,attributes:!0}),this.$select.addEventListener("keyup",this.onSelectKeyUp.bind(this)),this.addEventListener("keyup",this.onKeyUp.bind(this)),this.addEventListener("focusout",(e=>{this.contains(e.relatedTarget)||this.close()}))}onSelectKeyUp(e){e||(e=window.event),e.keyCode>=65&&e.keyCode<=90&&(e.returnValue=!1,e.cancel=!0)}onKeyUp(e){if(e.stopPropagation(),!this.$optionsList)return;if(e.keyCode>90||e.keyCode<48)return;this.pressedKey+=e.key;const s=this.$optionsList.querySelector(`li[${t.optionValueLowerCase}^="${this.pressedKey.toLowerCase()}"]`);s&&(s.focus(),this.$optionsList.scrollTop=s.offsetTop,setTimeout((()=>{this.pressedKey=""}),400))}renderSelect(){this.$options=Array.from(this.$select.querySelectorAll("option")),this.selectedOption=this.$options.find((e=>e.selected)),this.querySelector("select ~ ul")?.remove(),this.querySelector("select ~ div")?.remove(),this.$optionsList=document.createElement("ul"),this.$currentOption=document.createElement("div"),this.$currentOption.textContent=this.selectedOption?.textContent||this.placeholder,this.$options.forEach(((e,s)=>{const i=document.createElement("li");i.className=e.className,i.textContent=e.textContent,i.setAttribute(t.optionValue,e.value),i.setAttribute(t.optionValueLowerCase,e.value.toLowerCase()),i.setAttribute(t.optionIndex,s),i.setAttribute("tabindex","0"),e.disabled&&i.setAttribute("disabled",!0),e.hidden&&i.setAttribute("hidden",!0),e.selected&&(i.setAttribute(t.optionSelected,!0),this.$selectedOption=i),this.$optionsList.appendChild(i)})),this.$select.parentElement.append(this.$currentOption,this.$optionsList),this.toggleAttribute(t.stateSelected,!this.$select.value.includes("reset"))}close(){this.removeAttribute("open")}onClick(e){this.toggleAttribute("open");const s=e.target;s.hasAttribute(t.optionValue)&&(this.$selectedOption.removeAttribute(t.optionSelected),this.$selectedOption=s,this.$selectedOption.setAttribute(t.optionSelected,!0),this.$currentOption.textContent=this.$selectedOption.textContent,this.$select.selectedIndex=this.$selectedOption.getAttribute(t.optionIndex),this.$select.dispatchEvent(new Event("change",{bubbles:!0})),this.toggleAttribute(t.stateSelected,!this.$select.value.includes("reset")))}}customElements.define(e,s)})();