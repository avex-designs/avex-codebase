(()=>{const e="load-more-pagination",t="shopify-section-",n="load-more",i="load-prev",s={content:`data-${e}-content`,container:`data-${e}-container`,loadingClass:`data-${e}-loading-class`,link:`data-${e}-link`};class o extends HTMLElement{#isLoading=!1;connectedCallback(){this.#addEventListeners()}#addEventListeners(){const e=`[${s.container}="load-more"] [${s.link}]`,t=`[${s.container}="load-prev"] [${s.link}]`;this.querySelectorAll(`${t}, ${e}`).forEach((e=>{const t=e.closest(`[${s.container}`).getAttribute(s.container);e.addEventListener("click",(n=>{n.preventDefault(),this.#fetch(e.href,t)}))}))}#fetch(e,i){if(this.#isLoading)return;const s=new URL(e,window.location.origin),o=this.closest('[id^="shopify-section-"]');if(!o)throw new Error("[load-more-pagination] [The component must be within a Shopify section]");const a=o.id.replace(t,"");i===n&&window.history.pushState(Object.fromEntries(s.searchParams),"",s.href),s.search=s.search+`&section_id=${a}`,this.#isLoading=!0,this.#addLoadingClasses(this.#isLoading,i),fetch(s).then((e=>e.text())).then((e=>{this.#render(e,i)})).finally((()=>{this.#isLoading=!1,this.#addLoadingClasses(this.#isLoading,i)}))}#addLoadingClasses(e,t){this.querySelectorAll(`[${s.loadingClass}]`).forEach((n=>{let i="",o="";const a=(n.getAttribute(s.loadingClass)||"").split("|");a.length>1?(i=a[0],o=a[1]):o=a[0],o&&(!e||i&&i!==t?n.classList.remove(o):n.classList.add(o))}))}#render(e,t){const o=(new DOMParser).parseFromString(e,"text/html");this.querySelectorAll(`[${s.container}]`).forEach((e=>{const a=e.getAttribute(s.container);if(!a)return;const r=o.querySelector(`[${s.container}="${a}"]`);r&&(t===n&&a===n||t===i&&a===i)&&(e.innerHTML=r.innerHTML)}));const a=this.querySelector(`[${s.content}]`),r=o.querySelector(`[${s.content}]`);a&&r?a.insertAdjacentHTML(t===i?"afterbegin":"beforeend",r.innerHTML):console.warn(`[load-more-pagination] [The ${s.content} isn't found on the page or in the ajax response]`),this.#addEventListeners()}}customElements.define(e,o)})();