(()=>{"use strict";const e=(e,t,n)=>{e.querySelectorAll(`[${t}]`).forEach((e=>{const s=e.getAttribute(t);s&&(n?e.classList.add(s):e.classList.remove(s))}))};const t="load-more-pagination",n="load-more",s="load-prev",i={content:`data-${t}-content`,container:`data-${t}-container`,loadingClass:`data-${t}-loading-class`,loadingPrevClass:`data-${t}-loading-prev-class`,loadingMoreClass:`data-${t}-loading-more-class`,link:`data-${t}-link`};class o extends HTMLElement{#isLoading=!1;connectedCallback(){this.#addEventListeners()}#addEventListeners(){const e=`[${i.container}="load-more"] [${i.link}]`,t=`[${i.container}="load-prev"] [${i.link}]`;this.querySelectorAll(`${t}, ${e}`).forEach((e=>{const t=e.closest(`[${i.container}`).getAttribute(i.container);e.addEventListener("click",(n=>{n.preventDefault(),this.#fetch(e.href,t)}))}))}#fetch(e,t){if(this.#isLoading)return;const s=new URL(e,window.location.origin),[i]=(e=>{const t="shopify-section-",n=e.closest('[id^="shopify-section-"]');return n?[n.id.replace(t,""),n]:[null,null]})(this);if(!i)throw new Error("[load-more-pagination] [The component must be within a Shopify section]");t===n&&window.history.pushState(Object.fromEntries(s.searchParams),"",s.href),s.search=s.search+`&section_id=${i}`,this.#isLoading=!0,this.#addLoadingClasses(this.#isLoading,t),fetch(s).then((e=>e.text())).then((e=>{this.#render(e,t)})).finally((()=>{this.#isLoading=!1,this.#addLoadingClasses(this.#isLoading,t)}))}#addLoadingClasses(t,o){e(this,i.loadingClass,t),e(this,i.loadingPrevClass,t&&o===s),e(this,i.loadingMoreClass,t&&o===n)}#render(e,t){const o=(new DOMParser).parseFromString(e,"text/html");this.querySelectorAll(`[${i.container}]`).forEach((e=>{const a=e.getAttribute(i.container);if(!a)return;const r=o.querySelector(`[${i.container}="${a}"]`);r&&(t===n&&a===n||t===s&&a===s)&&(e.innerHTML=r.innerHTML)}));const a=this.querySelector(`[${i.content}]`),r=o.querySelector(`[${i.content}]`);a&&r?a.insertAdjacentHTML(t===s?"afterbegin":"beforeend",r.innerHTML):console.warn(`[load-more-pagination] [The ${i.content} isn't found on the page or in the ajax response]`),this.#addEventListeners()}}customElements.define(t,o)})();