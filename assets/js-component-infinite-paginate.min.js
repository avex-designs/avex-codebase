(()=>{"use strict";const e=(e,t,n)=>{e.querySelectorAll(`[${t}]`).forEach((e=>{const s=e.getAttribute(t);s&&(n?e.classList.add(s):e.classList.remove(s))}))};const t="infinite-paginate",n="load-more",s="load-prev",i={content:`data-${t}-content`,container:`data-${t}-container`,loadingClass:`data-${t}-loading-class`,loadingPrevClass:`data-${t}-loading-prev-class`,loadingMoreClass:`data-${t}-loading-more-class`,link:`data-${t}-link`};class o extends HTMLElement{_isLoading=!1;connectedCallback(){this._addEventListeners()}_addEventListeners(){const e=`[${i.container}="${n}"] [${i.link}]`,t=`[${i.container}="${s}"] [${i.link}]`;this.querySelectorAll(`${t}, ${e}`).forEach((e=>{const t=e.closest(`[${i.container}`).getAttribute(i.container);e.addEventListener("click",(n=>{n.preventDefault(),this._fetch(e.href,t)}))}))}_fetch(e,s){if(this._isLoading)return;const i=new URL(e,window.location.origin),[o]=(e=>{const t="shopify-section-",n=e.closest(`[id^="${t}"]`);return n?[n.id.replace(t,""),n]:[null,null]})(this);if(!o)throw new Error(`[${t}] [The component must be within a Shopify section]`);s===n&&window.history.pushState(Object.fromEntries(i.searchParams),"",i.href),i.search=i.search+`&section_id=${o}`,this._isLoading=!0,this._addLoadingClasses(this._isLoading,s),fetch(i).then((e=>e.text())).then((e=>{this._render(e,s)})).finally((()=>{this._isLoading=!1,this._addLoadingClasses(this._isLoading,s)}))}_addLoadingClasses(t,o){e(this,i.loadingClass,t),e(this,i.loadingPrevClass,t&&o===s),e(this,i.loadingMoreClass,t&&o===n)}_render(e,o){const a=(new DOMParser).parseFromString(e,"text/html");this.querySelectorAll(`[${i.container}]`).forEach((e=>{const r=e.getAttribute(i.container);if(!r)throw new Error(`[${t}] [A "${i.container}" element doesn't have an attribute value]`);const c=a.querySelector(`[${i.container}="${r}"]`);if(!c)throw new Error(`[${t}] [Corresponding element for [${i.container}="${r}"] isn't received in the AJAX response]`);(o===n&&r===n||o===s&&r===s)&&(e.innerHTML=c.innerHTML)}));const r=this.querySelector(`[${i.content}]`),c=a.querySelector(`[${i.content}]`);r&&c?r.insertAdjacentHTML(o===s?"afterbegin":"beforeend",c.innerHTML):console.warn(`[${t}] [The ${i.content} isn't found on the page or in the ajax response]`),this._addEventListeners()}}customElements.define(t,o)})();