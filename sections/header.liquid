{%- liquid
  capture logo_html
    render 'site-logo', logo_image: section.settings.logo_image, logo_text: section.settings.logo_svg
  endcapture
-%}

<header>
  <div>
    <div>{{ logo_html }}</div>
    {%- assign menu_blocks = section.settings.blocks | where: 'type', 'menu_item' | map: 'settings' -%}
    {%- if menu_blocks.size > 0 -%}
      <nav>
        <ul>
          {%- for menu_item in menu_blocks -%}
            {%- assign menu_item_title = menu_item.title | default: menu_item.linklist.title -%}
            <li>
              <a href="{{ menu_item.url }}">
                {{ menu_item_title | escape }}
              </a>
            </li>
          {%- endfor -%}
        </ul>
      </nav>
    {%- endif -%}
  </div>
</header>

{%- if request.page_type == 'index' -%}
  {%- assign potential_action_target = shop.url | append: routes.search_url | append: '?q={search_term_string}' -%}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": {{ shop.name | json }},
      "potentialAction": {
        "@type": "SearchAction",
        "target": {{ potential_action_target | json }},
        "query-input": "required name=search_term_string"
      },
      "url": {{ shop.url | append: page.url | json }}
    }
  </script>
{%- endif -%}

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo_image",
      "label": "Logo Image"
    },
    {
      "type": "html",
      "id": "logo_svg",
      "label": "Logo SVG",
      "info": "Will be used in case Logo Image is not set"
    }
  ],
  "blocks": [
    {
      "type": "menu_item",
      "name": "Menu Item",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "info": "Will override default navigation title"
        },
        {
          "type": "url",
          "id": "url",
          "label": "URL"
        },
        {
          "type": "link_list",
          "id": "linklist",
          "label": "Submenu"
        },
        {
          "type": "header",
          "content": "Promo Block"
        },
        {
          "type": "image_picker",
          "id": "promo_image",
          "label": "Promo Image"
        },
        {
          "type": "text",
          "id": "promo_heading",
          "label": "Promo Heading"
        },
        {
          "type": "text",
          "id": "promo_link_text",
          "label": "Promo Link Text"
        },
        {
          "type": "url",
          "id": "promo_link_url",
          "label": "Promo Link URL"
        }
      ]
    }
  ]
}
{% endschema %}
